webpackJsonp([11],{299:function(e,t,n){"use strict";e.exports=function(e){var t=n(1),s=n(43),r=n(177),o=n(189),i=n(179),a=n(183);return i.getUserRole()===Enums.UserRole.NormalUser?{start:function(e){i.subscribeEvent("MailWebclient::AddMoreSectionCommand",function(e){e({Text:s.i18n("MAILSAVEMESSAGEASPDFPLUGIN/ACTION_DOWNLOAD_PDF"),CssClass:"pdf",Handler:function(){if(this.currentMessage()){var e=this.currentMessage().getDomText(),n=function(e){try{var t=document.createElement("canvas"),n=null;t.width=e.width,t.height=e.height,n=t.getContext("2d"),n.drawImage(e,0,0),e.src=t.toDataURL("image/png")}catch(e){}};t("img[data-x-src-cid]",e).each(function(){n(this)}),o.send("MailSaveMessageAsPdfPlugin","GeneratePdfFile",{FileName:this.subject(),Html:e.html()},function(e){e.Result&&e.Result.Actions&&e.Result.Actions.download?r.downloadByUrl(e.Result.Actions.download.url):e.ErrorCode===Enums.Errors.LibraryNoFound?a.showError(s.i18n("MAILSAVEMESSAGEASPDFPLUGIN/ERROR_NO_PDF_GENERATOR_FOUND")):a.showError(s.i18n("MAILSAVEMESSAGEASPDFPLUGIN/ERROR_CREATING_PDF"))},this)}}})})}}:null}}});