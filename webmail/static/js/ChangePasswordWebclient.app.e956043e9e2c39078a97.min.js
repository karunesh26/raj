webpackJsonp([3],{246:function(s,o,t){"use strict";s.exports=function(s){var o=t(179);if(o.getUserRole()===Enums.UserRole.NormalUser){var n=t(247);return n.init(s),{start:function(s){s.run("SettingsWebclient","registerSettingsTabSection",[function(){return t(248)},"common","common"])},getChangePasswordPopup:function(){return t(249)}}}return null}},247:function(s,o,t){"use strict";var n=t(2),e=t(44);s.exports={PasswordMinLength:0,PasswordMustBeComplex:!1,init:function(s){var o=s.ChangePasswordWebclient,t=s.Mail;n.isEmpty(o)||(this.PasswordMinLength=e.pNonNegativeInt(o.PasswordMinLength,this.PasswordMinLength),this.PasswordMustBeComplex=e.pBool(o.PasswordMustBeComplex,this.PasswordMustBeComplex)),n.isEmpty(t)||(this.MailAllowAddAccounts=t.AllowAddAccounts,this.MailAllowMultiAccounts=t.AllowMultiAccounts)}}},248:function(s,o,t){"use strict";function n(){this.oSingleMailAccount=null,this.showChangePasswordButton=i.observable(!1),this.init()}var e=t(2),i=t(46),r=t(42),a=t(184),c=r.run("ChangePasswordWebclient","getChangePasswordPopup"),h=t(247);n.prototype.ViewTemplate="ChangePasswordWebclient_ChangeSingleMailAccountPasswordView",n.prototype.init=function(){var s=r.run("MailWebclient","getAccountList",[]);s&&e.isFunction(s.collection)&&1===s.collection().length&&!h.MailAllowAddAccounts&&(this.oSingleMailAccount=s.collection()[0],this.showChangePasswordButton(!0))},n.prototype.changePassword=function(){this.oSingleMailAccount&&a.showPopup(c,[{iAccountId:this.oSingleMailAccount.id(),sModule:"Mail",bHasOldPassword:!0}])},s.exports=new n},249:function(s,o,t){"use strict";function n(){u.call(this),this.currentPassword=r.observable(""),this.newPassword=r.observable(""),this.confirmPassword=r.observable(""),this.accountId=r.observable(""),this.hasOldPassword=r.observable(!1),this.oParams=null}var e=t(2),i=t(1),r=t(46),a=t(43),c=t(189),h=t(181),l=t(183),u=t(186),d=t(247);e.extendOwn(n.prototype,u.prototype),n.prototype.PopupTemplate="ChangePasswordWebclient_ChangePasswordPopup",n.prototype.onOpen=function(s){this.currentPassword(""),this.newPassword(""),this.confirmPassword(""),this.accountId(s.iAccountId),this.hasOldPassword(s.bHasOldPassword),this.oParams=s},n.prototype.change=function(){var s=i.trim(this.newPassword()),o=i.trim(this.confirmPassword());o!==s?l.showError(a.i18n("COREWEBCLIENT/ERROR_PASSWORDS_DO_NOT_MATCH")):d.PasswordMinLength>0&&s.length<d.PasswordMinLength?l.showError(a.i18n("CHANGEPASSWORDWEBCLIENT/ERROR_PASSWORD_TOO_SHORT").replace("%N%",d.PasswordMinLength)):!d.PasswordMustBeComplex||s.match(/([0-9])/)&&s.match(/([!,%,&,@,#,$,^,*,?,_,~])/)?this.sendChangeRequest():l.showError(a.i18n("CHANGEPASSWORDWEBCLIENT/ERROR_PASSWORD_TOO_SIMPLE"))},n.prototype.sendChangeRequest=function(){var s={AccountId:this.accountId(),CurrentPassword:i.trim(this.currentPassword()),NewPassword:i.trim(this.newPassword())};c.send(this.oParams.sModule,"ChangePassword",s,this.onUpdatePasswordResponse,this)},n.prototype.onUpdatePasswordResponse=function(s,o){s.Result===!1?h.showErrorByCode(s,a.i18n("CHANGEPASSWORDWEBCLIENT/ERROR_PASSWORD_NOT_SAVED")):(this.hasOldPassword()?l.showReport(a.i18n("CHANGEPASSWORDWEBCLIENT/REPORT_PASSWORD_CHANGED")):l.showReport(a.i18n("CHANGEPASSWORDWEBCLIENT/REPORT_PASSWORD_SET")),this.closePopup(),i.isFunction(this.oParams.fAfterPasswordChanged)&&this.oParams.fAfterPasswordChanged())},s.exports=new n}});