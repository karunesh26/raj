webpackJsonp([16],{376:function(e,t,r){"use strict";e.exports=function(e){var t=r(2),o=r(1),n=r(46),s=r(191),i=r(43),u=r(189),a=r(179),c=r(377),h=a.getUserRole()===Enums.UserRole.NormalUser,l=a.getUserRole()===Enums.UserRole.Anonymous,d=function(e){switch(e.ErrorCode){case c.EOAuthIntegratorError.ServiceNotAllowed:return i.i18n("OAUTHINTEGRATORWEBCLIENT/ERROR_SERVICE_NOT_ALLOWED");case c.EOAuthIntegratorError.AccountNotAllowedToLogIn:return i.i18n("OAUTHINTEGRATORWEBCLIENT/ERROR_ACCOUNT_NOT_ALLOWED");case c.EOAuthIntegratorError.AccountAlreadyConnected:return i.i18n("OAUTHINTEGRATORWEBCLIENT/ERROR_ACCOUNT_ALREADY_CONNECTED")}return""};return c.init(e),l?{start:function(e){c.oauthServices=n.observableArray([]);var t=function(){var e=s.getCurrentHashArray();return e.length>=2&&e[0]===c.RegisterModuleHash?e[1]:""},r=function(e){if("CLoginView"===e.Name||"CRegisterView"===e.Name){t();e.View.externalAuthClick=function(t){o.cookie("oauth-redirect","CLoginView"===e.Name?"login":"register"),o.cookie("oauth-scopes","auth"),window.location.href="?oauth="+t},e.View.oauthServices=c.oauthServices}};u.send(c.ServerModuleName,"GetServices",null,function(e){c.oauthServices(e.Result)},this),a.subscribeEvent("StandardLoginFormWebclient::ConstructView::after",r),a.subscribeEvent("StandardRegisterFormWebclient::ConstructView::after",r)},getErrorMessageByCode:d}:h?{start:function(e){var r=function(){u.send(c.ServerModuleName,"GetAccounts",null,function(e){var r=0;t.isArray(e.Result)&&t.each(e.Result,function(e){e.Scopes.indexOf("auth")!==-1&&r++}),c.userAccountsCount(r)})};a.subscribeEvent("OAuthAccountChange::after",function(){r()}),r()},getCreateLoginPasswordView:function(){return r(378)},getErrorMessageByCode:d}:null}},377:function(e,t,r){"use strict";var o=r(2),n=r(46),s=r(44),i=r(179);e.exports={ServerModuleName:"OAuthIntegratorWebclient",HashModuleName:"oauth-integrator",AuthModuleName:"StandardAuth",OnlyPasswordForAccountCreate:!0,userAccountsCount:n.observable(0),EOAuthIntegratorError:{},Services:[],init:function(e){var t=e.OAuthIntegratorWebclient;o.isEmpty(t)||(this.AuthModuleName=s.pString(t.AuthModuleName,this.AuthModuleName),this.OnlyPasswordForAccountCreate=s.pBool(t.OnlyPasswordForAccountCreate,this.OnlyPasswordForAccountCreate),this.Services=s.pArray(t.Services,this.Services),this.EOAuthIntegratorError=s.pObject(t.EOAuthIntegratorError)),i.registerUserAccountsCount(this.userAccountsCount)},updateAdmin:function(e){o.each(this.Services,function(t){var r=e[t.Name];r&&(t.EnableModule=r.EnableModule,t.Id=r.Id,t.Secret=r.Secret)})}}},378:function(e,t,r){"use strict";function o(){this.visible=s.computed(function(){return h.OnlyPasswordForAccountCreate&&!u.isNonEmptyString(c.firstAccountWithPassLogin())}),this.password=s.observable(""),this.passwordFocus=s.observable(!1),this.confirmPassword=s.observable(""),this.confirmPasswordFocus=s.observable(!1),this.login=s.computed(function(){return c.getUserPublicId()},this)}var n=r(1),s=r(46),i=r(43),u=r(44),a=r(183),c=r(179),h=r(377);o.prototype.ViewTemplate="OAuthIntegratorWebclient_CreateLoginPasswordView",o.prototype.setPassword=function(){var e=n.trim(this.login()),t=n.trim(this.password()),r=n.trim(this.confirmPassword());return""===t?void this.passwordFocus(!0):t!==r?(a.showError(i.i18n("COREWEBCLIENT/ERROR_PASSWORDS_DO_NOT_MATCH")),void this.confirmPasswordFocus(!0)):void c.broadcastEvent(h.AuthModuleName+"::CreateUserAuthAccount",{Login:e,Password:t})},e.exports=new o}});